<!--
 - Created by BRITENET on 04.02.2019.
 -->

<aura:component description="ECS_ProductCard" controller="ECS_CarsManagerController"
                implements="forceCommunity:availableForAllPageTypes,flexipage:availableForAllPageTypes" access="global">


    <aura:attribute name="carImages" type="String[]"/>
    <aura:attribute name="selectedCarsIds" type="String[]"/>
    <aura:attribute name="carStandardPrice" type="Currency"/>
    <aura:attribute name="carCurrentLowestPrice" type="Currency"/>
    <aura:attribute name="orgUrl" type="String"/>
    <aura:attribute name="isAdmin" type="Boolean" default="false"/>
    <aura:attribute name="car" type="Product2"/>
    <aura:attribute name="carIsFromHotSale" type="Boolean" default="false"/>

    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:handler name="ReviewAdded" event="c:ECS_ReviewAdded" action="{!c.onReviewAdded}"/>

    <lightning:layout>
        <lightning:layoutItem size="12">
            <lightning:card iconName=""
                            title="{!!equals(v.carIsFromHotSale, true) ? v.car.Name:''}"
                            variant="narrow">
                <div class="slds-p-horizontal--small">
                    <fieldset class="slds-form--compound">
                        <div class="slds-form-element__group">
                            <div class="slds-form-element__row slds-grid_vertical-align-start">
                                <div class="slds-form-element slds-size--1-of-2">
                                    <aura:if isTrue="{!v.car.ECS_ImageID__c}">
                                        <img src="{!v.orgUrl+'/sfc/servlet.shepherd/document/download/'
                                                +v.car.ECS_ImageID__c}"/>
                                        <aura:set attribute="else">
                                            <img src="{!$Resource.ECS_defaultCarImage}"/>
                                        </aura:set>
                                    </aura:if>
                                </div>
                                <div class="slds-form-element slds-size--1-of-2" style="text-align:center">
                                    <lightning:button name="{!$Label.c.ECS_Add_To_Cart}"
                                                      onclick="{!c.onCarAddedToCart}"
                                                      class="{!equals(v.carIsFromHotSale, true) ? 'carIsFromHotSale':''}">
                                        <lightning:icon iconName="action:new" size="medium"/>
                                        &nbsp;{!$Label.c.ECS_Add_To_Cart}
                                    </lightning:button>
                                    <lightning:button name="{!$Label.c.ECS_Go_To_Cart}" onclick="{!c.redirectToCart}"
                                                      class="{!equals(v.carIsFromHotSale, true) ? 'carIsFromHotSale':''}">
                                        <lightning:icon iconName="action:view_relationship" size="medium"/>
                                        &nbsp;{!$Label.c.ECS_Go_To_Cart}
                                    </lightning:button>
                                    <aura:if isTrue="{!v.carImages.length >= 2}">
                                        <lightning:button name="{!$Label.c.ECS_Show_All_Pictures}"
                                                          onclick="{!c.openAllFiles}"
                                                          class="{!equals(v.carIsFromHotSale, true) ? 'carIsFromHotSale':''}"
                                                          variant="neutral">
                                            <lightning:icon iconName="action:preview" size="medium"/>
                                            &nbsp;{!$Label.c.ECS_Show_All_Pictures}
                                        </lightning:button>
                                    </aura:if>
                                    <div class="{!equals(v.carIsFromHotSale, true) ? 'carIsFromHotSale':'priceProductCard'}">
                                        <h1 class="{!v.carStandardPrice == v.carCurrentLowestPrice?'slds-hide':
                                                'slds-truncate sale-price'}"> {!v.carStandardPrice+' €'}</h1>
                                        <h3> {!v.carCurrentLowestPrice+' €'}</h3>

                                    </div>
                                    <lightning:button name="{!$Label.c.ECS_Go_to_Product}"
                                                      onclick="{!c.redirectToDetailsPage}" value="{!v.car.Id}"
                                                      class="{!equals(v.carIsFromHotSale, true) ? '':'carIsFromHotSale'}">
                                        <lightning:icon iconName="action:info" size="medium"/>
                                        &nbsp;{!$Label.c.ECS_Go_to_Product}
                                    </lightning:button>
                                </div>
                            </div>
                            <div class="slds-form-element__row slds-grid_vertical-align-end">
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Product_Name}: </p>

                                    <ui:outputText value="{!v.car.Name}" title="{!$Label.c.ECS_Product_Name}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">{!$Label.c.ECS_Model}: </p>
                                    <ui:outputText value="{!v.car.ECS_Model__c}" title="{!$Label.c.ECS_Model}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="{!equals(v.carIsFromHotSale, true) ?
                                        'carIsFromHotSale slds-form-element slds-size--1-of-3'
                                        : 'slds-form-element slds-size--1-of-3'}">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Engine_Size}: </p>
                                    <ui:outputText value="{!v.car.ECS_EngineSize__c}"
                                                   title="{!$Label.c.ECS_Engine_Size}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                            </div>
                            <div class="{!equals(v.carIsFromHotSale, true) ?
                                    'carIsFromHotSale slds-form-element__row slds-grid_vertical-align-end'
                                    : 'slds-form-element__row slds-grid_vertical-align-end'}">
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">{!$Label.c.ECS_Year}: </p>
                                    <ui:outputText value="{!v.car.ECS_ProductionYear__c}" title="{!$Label.c.ECS_Year}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">{!$Label.c.ECS_VIN}: </p>
                                    <ui:outputText value="{!v.car.ECS_VinNumber__c}" title="{!$Label.c.ECS_VIN}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">{!$Label.c.ECS_Fuel_Type}: </p>
                                    <ui:outputText value="{!v.car.ECS_FuelType__c}" title="{!$Label.c.ECS_Fuel_Type}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                            </div>

                            <div class="{!equals(v.carIsFromHotSale, true) ?
                                    'carIsFromHotSale slds-form-element__row slds-grid_vertical-align-end'
                                    : 'slds-form-element__row slds-grid_vertical-align-end'}">
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Body_Style}: </p>
                                    <ui:outputText value="{!v.car.ECS_BodyStyle__c}" title="{!$Label.c.ECS_Body_Style}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Transmission}: </p>
                                    <ui:outputText value="{!v.car.ECS_Transmission__c}"
                                                   title="{!$Label.c.ECS_Transmission}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                                <div class="slds-form-element slds-size--1-of-3">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Battery_Capacity}: </p>
                                    <ui:outputText value="{!v.car.ECS_BatteryCapacity__c+' '+$Label.c.ECS_Kwh}"
                                                   title="{!$Label.c.ECS_Battery_Capacity}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                            </div>

                            <div class="{!equals(v.carIsFromHotSale, true) ?
                                    'carIsFromHotSale slds-form-element__row slds-grid_vertical-align-end'
                                    : 'slds-form-element__row slds-grid_vertical-align-end'}">
                                <div class="slds-form-element slds-size--1-of-1">
                                    <p class="slds-text-body_small slds-text-color_weak">
                                    {!$Label.c.ECS_Description}: </p>
                                    <ui:outputText value="{!v.car.Description}" title="{!$Label.c.ECS_Description}"
                                                   class="slds-text-heading_medium"/>
                                </div>
                            </div>
                        </div>
                    </fieldset>
                </div>

                <div class="{!equals(v.carIsFromHotSale, true) ?
                        'carIsFromHotSale slds-form-element__row slds-grid_vertical-align-end'
                        : 'slds-form-element__row slds-grid_vertical-align-end'}">
                    <lightning:tabset variant="scoped">
                        <lightning:tab title="{!$Label.c.ECS_Reviews}"
                                       label="{!$Label.c.ECS_Reviews}">
                            <c:ECS_ReviewsOnCard car="{!v.car}"/>
                        </lightning:tab>
                        <lightning:tab title="{!$Label.c.ECS_Service_Map}"
                                       label="{!$Label.c.ECS_Service_Map}">
                            <c:ECS_CarServiceMap car="{!v.car}"/>
                        </lightning:tab>
                        <lightning:tab title="{!$Label.c.ECS_VideoPresentation}"
                                       label="{!$Label.c.ECS_VideoPresentation}">
                            <c:ECS_VideoPresentation car="{!v.car}"/>
                        </lightning:tab>
                    </lightning:tabset>
                </div>
            </lightning:card>
        </lightning:layoutItem>
    </lightning:layout>
</aura:component>





