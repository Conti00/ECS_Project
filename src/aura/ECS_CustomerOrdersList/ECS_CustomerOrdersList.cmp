<!--
 - Created by BRITENET on 06.02.2019.
 -->

<aura:component description="ECS_CustomerOrdersList"
                    implements="forceCommunity:availableForAllPageTypes,flexipage:availableForAllPageTypes" access="global"
                    controller="ECS_CarsManagerController">

        <aura:attribute name="customerOrdersItems" type="Object[]"/>
        <aura:attribute name="ordersTotalAmount" type="Decimal"/>
        <aura:attribute name="selectedOrderId" type="String"/>
        <aura:handler name="change" value="{!v.customerOrdersItems}" action="{!c.onOrderItemsChange}"/>
        <aura:registerEvent name="orderItemSelected" type="c:ECS_SelectedTableRowEvent"/>

        <lightning:card title="{!$Label.c.ECS_My_Orders}"  class="slds-tabs_card" footer="">
            <aura:set attribute="actions"/>
            <lightning:layout horizontalAlign="center" verticalAlign="center" multipleRows='true'>
                <table class="slds-table slds-table_bordered slds-table_cell-buffer ">
                    <thead>
                     <tr class="slds-text-title_caps">
                        <th scope="col">
                            <div class="slds-truncate">{!$Label.c.ECS_NO}</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate">{!$Label.c.ECS_Order_Number}</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate">{!$Label.c.ECS_Order_Date}</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate">{!$Label.c.ECS_Cars}</div>
                        </th>
                        <th scope="col">
                            <div class="slds-truncate">{!$Label.c.ECS_Amount}</div>
                        </th>
                     </tr>
                    </thead>

                    <tbody>
                     <aura:iteration items="{!v.customerOrdersItems}" var="orderItem" indexVar="index">
                        <tr aura:id="tableRow" onclick="{!c.tableRowClicked}" data-id="{!orderItem.Id}"
                            data-index="{!index}" >
                            <td data-label="{!$Label.c.ECS_NO}">
                                <lightning:formattedNumber value="{!index + 1}"/>
                            </td>
                            <td data-label="{!$Label.c.ECS_Order_Number}">
                                <lightning:formattedText value="{!orderItem.OrderNumber}"/>
                            </td>
                            <td data-label="{!$Label.c.ECS_Year}">
                                <lightning:formattedDateTime day="2-digit" month="numeric" year="numeric"  hour="2-digit" minute="2-digit" value="{!orderItem.CreatedDate}"/>
                            </td>
                            <td data-label="{!$Label.c.ECS_Cars}">
                                <lightning:formattedNumber value="{!orderItem.OrderItems.length}"/>
                            </td>
                            <td data-label="{!$Label.c.ECS_Model}">
                                <lightning:formattedNumber style="currency" value="{!orderItem.TotalAmount}"/>
                            </td>
                        </tr>
                     </aura:iteration>
                    </tbody>
                </table>
            </lightning:layout>

            <footer class="slds-float_right slds-align-bottom">
                <lightning:formattedText value="{!$Label.c.ECS_Total_Amount}"/>
                <ui:outputCurrency  value="{!v.ordersTotalAmount}"/>
            </footer>
        </lightning:card>

    </aura:component>
